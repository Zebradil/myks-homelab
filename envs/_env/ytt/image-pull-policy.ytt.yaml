#@ load("@ytt:overlay", "overlay")

#@overlay/match by=lambda idx, left, right: left["kind"] in ["Deployment", "DaemonSet", "StatefulSet", "Job"], when="1+"
---
spec:
  template:
    spec:
      #@overlay/match when=1
      containers:
        - #@overlay/match by=overlay.all, when="1+"
          #@overlay/match when=1
          #@overlay/remove
          imagePullPolicy: ''
      #@overlay/match when=1
      initContainers:
        - #@overlay/match by=overlay.all, when="1+"
          #@overlay/match when=1
          #@overlay/remove
          imagePullPolicy: ''

#@overlay/match by=lambda idx, left, right: left["kind"] == "CronJob", when="1+"
---
spec:
  jobTemplate:
    spec:
      template:
        spec:
          #@overlay/match when=1
          containers:
            - #@overlay/match by=overlay.all, when="1+"
              #@overlay/match when=1
              #@overlay/remove
              imagePullPolicy: ''
          #@overlay/match when=1
          initContainers:
            - #@overlay/match by=overlay.all, when="1+"
              #@overlay/match when=1
              #@overlay/remove
              imagePullPolicy: ''
