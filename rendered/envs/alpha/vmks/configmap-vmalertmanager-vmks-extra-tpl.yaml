apiVersion: v1
data:
  telegram.tmpl: "{{- define \"alert_list\" -}}\n{{- range . -}}\n---\n<b>{{ .Labels.alertname | html }}</b>\n{{- if eq .Labels.severity \"critical\" }}\n\U0001F6A8 CRITICAL{{ end }}\n{{- if eq .Labels.severity \"warning\" }}\n⚠️ WARNING{{ end }}\n{{- with .Annotations.summary | html }}\n{{ . }}{{ end }}\n{{- with .Annotations.description }}\n{{ . }}{{ end }}\n\nLabels:\n{{ range .Labels.SortedPairs }}  <i>{{ .Name | html }}</i>: <code>{{ .Value | html }}</code>\n{{ end }}\n- <a href=\"{{ .GeneratorURL }}\">Source</a>\n{{- with .Annotations.runbook_url }}\n- <a href=\"{{ . }}\">Runbook</a>\n{{ end }}{{ end }}\n{{- end -}}\n\n{{- define \"telegram.message\" }}\n{{- if gt (len .Alerts.Firing) 0 -}}\n\U0001F525 Alerts Firing\n{{ template \"alert_list\" .Alerts.Firing }}{{ end }}\n{{- if gt (len .Alerts.Resolved) 0 -}}\n✅ Alerts Resolved\n{{ template \"alert_list\" .Alerts.Resolved }}{{ end }}\n<a href=\"{{ .ExternalURL }}\">Alertmanager UI</a>\n{{- end -}}"
kind: ConfigMap
metadata:
  annotations:
    a8r.io/repository: https://github.com/Zebradil/myks-homelab
  labels:
    app.kubernetes.io/component: victoria-metrics-k8s-stack-alertmanager
    app.kubernetes.io/instance: vmks
    app.kubernetes.io/name: victoria-metrics-k8s-stack
  name: vmalertmanager-vmks-extra-tpl
  namespace: vmks
